

# picdown

[![GitHub license](<https://img.shields.io/github/license/suyeden/picdown?color=blue>)](<https://github.com/suyeden/picdown/blob/master/LICENSE>)  


## 概要

Picture Downloader  

Webサイト上の画像ファイルを自動収集するための Emacs Lisp スクリプトです。  

Google Chrome の ヘッドレスモードを用いて Web ページの取得を行い、また Windows 10 にデフォルトで付いている curl.exe を使って画像ファイルのダウンロードを行っています。  
curl でも Web ページの取得はできるのですが、Headless-Chrome の方が画像ファイルの回収結果が良好だったため、Web ページの取得には Chrome を用いています。  


## 動作環境

-   Windows 10 Home
-   GNU Emacs 27.1 以上
-   Google Chrome 98.0.4758.102 以上
-   curl 7.79.1 以上 （Windows 10 であればデフォルトで付いているはず）


## 導入方法

1.  GNU Emacs をダウンロードして適当な場所に展開した上で、Emacs へのパスを通してください。
2.  Google Chrome をインストールしてください。
3.  本ページ横の Releases から `picdown.zip` をダウンロードし、展開してから中身を適当な場所に配置してください。  
    このとき、中身の `picdown.bat` ファイルと `picdown` フォルダは必ず同じ場所に置くようにしてください。


## 使用方法

`picdown.bat` を実行することで、picdown が起動します。  
初めて実行する時は「Windows によって PC が保護されました」というようなメッセージが出てくるかもしれませんが、「詳細情報」を押してから「実行」をクリックすると以降使えるようになります。危険なソフトではないので安心して使ってください。  

`picdown.bat` へのパスを通すか、または `picdown.bat` のパスを直接指定するなどして、コマンドプロンプトなどのコマンドライン環境から実行してください。  
あるいは、 `picdown.bat` をダブルクリックすることでも実行できます。  

画像ダウンロードをするにあたっては、 `picdown.txt` を作成してこのファイルに対象となる Web ページの URL を羅列していってください。  
picdown は `picdown.txt` に羅列された URL を読み取り、上から順に画像ファイルをダウンロードしていきます。  
`picdown.txt` が無い状態で picdown を起動しても、 `picdown.txt` を新たに作成してくれます。  

1つの URL につき1つのフォルダが作成され、ダウンロードされた画像はこのフォルダの中に格納されます。  
フォルダの名前は、それぞれの URL の Web ページのタイトルを取得して付けられます。  


## 作者メモ

本スクリプトの実行中、Web ページを取得するためにヘッドレスモードで Chrome を起動する際に、真っ黒のウィンドウが画面に一瞬映ります。これはどうも仕様でこうなっているみたいで、設定だけではどうしようもできなかったので、この問題の解消はこれからの課題にしていきたいと思います。  

またおそらく JavaScript によるファイルの動的読み込みに起因して、Twitter や Google の画像検索の結果などのようなページでは画像のダウンロードができません。これもそのうち解決できるようにしたいと思います。  

ダウンロード操作の際に、相手のサイトに集中して大量のアクセスを送ってしまうと、サーバーに負荷をかけて多くに人に迷惑をかけることになるため、本スクリプトではマナー対策としてダウンロードの間隔を5秒開けるように設定しています。  


## 注意事項

画像をダウンロードする際には、著作権法をしっかりと守り、常識の範囲内で、また個人の責任のもとで行ってください。  

